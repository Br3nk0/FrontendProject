function Ghost(e,t,n,r){this.x=e;this.y=t;this.color=n;this.dir=r;this.isWeak=false;this.radius=Ghost_Radius;this.isMoving=false;this.isBlinking=false;this.isDead=false;this.speed=speed;this.stepCounter=0}Ghost.prototype.toGhostHouse=function(){var e,t;switch(this.color){case Orange:e=ghostHouse[0][1]*Grid_Width+Grid_Width/2;t=ghostHouse[0][0]*Grid_Width+Grid_Width/2;console.log(e);break;case Cyan:e=ghostHouse[1][1]*Grid_Width+Grid_Width/2;t=ghostHouse[1][0]*Grid_Width+Grid_Width/2;break;case Pink:e=ghostHouse[2][1]*Grid_Width+Grid_Width/2;t=ghostHouse[2][0]*Grid_Width+Grid_Width/2;break;case Red:e=ghostHouse[3][1]*Grid_Width+Grid_Width/2;t=ghostHouse[3][0]*Grid_Width+Grid_Width/2;break}this.x=e;this.y=t;this.dir=Down;this.stepCounter=0};Ghost.prototype.draw=function(){if(!this.isDead){if(this.isWeak){if(this.isBlinking){ctx.fillStyle=Blinking_Color}else{ctx.fillStyle=Weak_Color}}else{ctx.fillStyle=this.color}ctx.beginPath();ctx.arc(this.x,this.y,this.radius,Math.PI,0,false);ctx.moveTo(this.x-this.radius,this.y);if(!this.isMoving){ctx.lineTo(this.x-this.radius,this.y+this.radius);ctx.lineTo(this.x-this.radius+this.radius/3,this.y+this.radius-this.radius/4);ctx.lineTo(this.x-this.radius+this.radius/3*2,this.y+this.radius);ctx.lineTo(this.x,this.y+this.radius-this.radius/4);ctx.lineTo(this.x+this.radius/3,this.y+this.radius);ctx.lineTo(this.x+this.radius/3*2,this.y+this.radius-this.radius/4);ctx.lineTo(this.x+this.radius,this.y+this.radius);ctx.lineTo(this.x+this.radius,this.y)}else{ctx.lineTo(this.x-this.radius,this.y+this.radius-this.radius/4);ctx.lineTo(this.x-this.radius+this.radius/3,this.y+this.radius);ctx.lineTo(this.x-this.radius+this.radius/3*2,this.y+this.radius-this.radius/4);ctx.lineTo(this.x,this.y+this.radius);ctx.lineTo(this.x+this.radius/3,this.y+this.radius-this.radius/4);ctx.lineTo(this.x+this.radius/3*2,this.y+this.radius);ctx.lineTo(this.x+this.radius,this.y+this.radius-this.radius/4);ctx.lineTo(this.x+this.radius,this.y)}ctx.fill()}if(this.isWeak){if(this.isBlinking){ctx.fillStyle="#f00";ctx.strokeStyle="f00"}else{ctx.fillStyle="white";ctx.strokeStyle="white"}ctx.beginPath();ctx.arc(this.x-this.radius/2.5,this.y-this.radius/5,this.radius/5,0,Math.PI*2,true);ctx.fill();ctx.beginPath();ctx.arc(this.x+this.radius/2.5,this.y-this.radius/5,this.radius/5,0,Math.PI*2,true);ctx.fill();ctx.beginPath();ctx.lineWidth=1;ctx.moveTo(this.x-this.radius+this.radius/5,this.y+this.radius/2);ctx.lineTo(this.x-this.radius+this.radius/3,this.y+this.radius/4);ctx.lineTo(this.x-this.radius+this.radius/3*2,this.y+this.radius/2);ctx.lineTo(this.x,this.y+this.radius/4);ctx.lineTo(this.x+this.radius/3,this.y+this.radius/2);ctx.lineTo(this.x+this.radius/3*2,this.y+this.radius/4);ctx.lineTo(this.x+this.radius-this.radius/5,this.y+this.radius/2);ctx.stroke()}else{ctx.fillStyle="white";ctx.beginPath();ctx.arc(this.x-this.radius/2.5,this.y-this.radius/5,this.radius/3,0,Math.PI*2,true);ctx.fill();ctx.fillStyle="white";ctx.beginPath();ctx.arc(this.x+this.radius/2.5,this.y-this.radius/5,this.radius/3,0,Math.PI*2,true);ctx.fill();switch(this.dir){case Up:ctx.fillStyle="black";ctx.beginPath();ctx.arc(this.x-this.radius/3,this.y-this.radius/5-this.radius/6,this.radius/6,0,Math.PI*2,true);ctx.fill();ctx.fillStyle="black";ctx.beginPath();ctx.arc(this.x+this.radius/3,this.y-this.radius/5-this.radius/6,this.radius/6,0,Math.PI*2,true);ctx.fill();break;case Down:ctx.fillStyle="black";ctx.beginPath();ctx.arc(this.x-this.radius/3,this.y-this.radius/5+this.radius/6,this.radius/6,0,Math.PI*2,true);ctx.fill();ctx.fillStyle="black";ctx.beginPath();ctx.arc(this.x+this.radius/3,this.y-this.radius/5+this.radius/6,this.radius/6,0,Math.PI*2,true);ctx.fill();break;case Left:ctx.fillStyle="black";ctx.beginPath();ctx.arc(this.x-this.radius/3-this.radius/5,this.y-this.radius/5,this.radius/6,0,Math.PI*2,true);ctx.fill();ctx.fillStyle="black";ctx.beginPath();ctx.arc(this.x+this.radius/3-this.radius/15,this.y-this.radius/5,this.radius/6,0,Math.PI*2,true);ctx.fill();break;case Right:ctx.fillStyle="black";ctx.beginPath();ctx.arc(this.x-this.radius/3+this.radius/15,this.y-this.radius/5,this.radius/6,0,Math.PI*2,true);ctx.fill();ctx.fillStyle="black";ctx.beginPath();ctx.arc(this.x+this.radius/3+this.radius/5,this.y-this.radius/5,this.radius/6,0,Math.PI*2,true);ctx.fill();break}}};Ghost.prototype.getRow=function(){return getRowIndex(this.y)};Ghost.prototype.getCol=function(){return getColIndex(this.x)};Ghost.prototype.moveOneStep=function(){var e=0;var t=0;if(!canMove(this.x,this.y,this.dir)){return}switch(this.dir){case Up:t=this.y-this.speed;if(t-this.radius-Wall_Width>0){this.y=t}break;case Down:t=this.y+this.speed;if(t+this.radius+Wall_Width<Canvas_Height){this.y=t}break;case Left:e=this.x-this.speed;if(e-this.radius-Wall_Width>0){this.x=e}break;case Right:e=this.x+this.speed;if(e+this.radius+Wall_Width<Canvas_Width){this.x=e}break;default:break}};Ghost.prototype.turnBack=function(){this.dir=oppositeDir(this.dir)};Ghost.prototype.move=function(){this.isMoving=!this.isMoving;if(this.isWeak){this.speed=speed/2;if(weakCounter===Weak_Duration){this.dir=oppositeDir(this.dir)}if(onGridCenter(this.x,this.y)===false){this.moveOneStep()}else{var e=maze[getRowIndex(this.y)][getColIndex(this.x)];if(e.gridType===Left_Top_Right){this.dir=Down;this.moveOneStep()}else if(e.gridType===Top_Right_Bottom){this.dir=Left;this.moveOneStep()}else if(e.gridType===Right_Bottom_Left){this.dir=Up;this.moveOneStep()}else if(e.gridType===Bottom_Left_Top){this.dir=Right;this.moveOneStep()}else{this.randomMove()}}this.stepCounter++}else{if(this.stepCounter!=0&&this.stepCounter%2!=0){this.speed=speed/2;this.stepCounter=0}else{this.speed=speed}if(onGridCenter(this.x,this.y)===false){this.moveOneStep()}else{var e=maze[getRowIndex(this.y)][getColIndex(this.x)];if(e.gridType===Left_Top_Right){this.dir=Down;this.moveOneStep()}else if(e.gridType===Top_Right_Bottom){this.dir=Left;this.moveOneStep()}else if(e.gridType===Right_Bottom_Left){this.dir=Up;this.moveOneStep()}else if(e.gridType===Bottom_Left_Top){this.dir=Right;this.moveOneStep()}else{switch(this.color){case Red:this.blinkyMove();break;case Cyan:case Orange:this.inkyMove();break;case Pink:this.pinkyMove();break}}}}};Ghost.prototype.blinkyMove=function(){this.moveToPacman(true)};Ghost.prototype.pinkyMove=function(){this.moveToPacman(false)};Ghost.prototype.inkyMove=function(){this.randomMove()};Ghost.prototype.moveToPacman=function(e){var t=Canvas_Width*Canvas_Height;var n,r,i,s;var o=this.dir;var u=t;if(o===Right||!canMove(this.x,this.y,Left)){n=u}else{n=this.getTestDistance(Left,e)}if(o===Left||!canMove(this.x,this.y,Right)){r=t}else{r=this.getTestDistance(Right,e)}if(o===Down||!canMove(this.x,this.y,Up)){i=t}else{i=this.getTestDistance(Up,e)}if(o===Up||!canMove(this.x,this.y,Down)){s=t}else{s=this.getTestDistance(Down,e)}this.dir=o;u=Math.min(Math.min(n,r),Math.min(i,s));switch(u){case n:this.dir=Left;break;case r:this.dir=Right;break;case i:this.dir=Up;break;case s:this.dir=Down;break}this.moveOneStep()};Ghost.prototype.getTestDistance=function(e,t){var n=0;this.dir=e;this.moveOneStep();if(t){n=Math.sqrt(Math.pow(this.x-mrPacman.x,2)+Math.pow(this.y-mrPacman.y,2))}else{switch(mrPacman.dir){case Left:n=Math.sqrt(Math.pow(this.x-(mrPacman.x-4*Grid_Width),2)+Math.pow(this.y-mrPacman.y,2));break;case Right:n=Math.sqrt(Math.pow(this.x-(mrPacman.x+4*Grid_Width),2)+Math.pow(this.y-mrPacman.y,2));break;case Up:n=Math.sqrt(Math.pow(this.x-mrPacman.x,2)+Math.pow(this.y-(mrPacman.y-4*Grid_Height),2));break;case Down:n=Math.sqrt(Math.pow(this.x-mrPacman.x,2)+Math.pow(this.y-(mrPacman.y+4*Grid_Height),2));break;default:n=Math.sqrt(Math.pow(this.x-mrPacman.x,2)+Math.pow(this.y-mrPacman.y,2));break}}this.turnBack();this.moveOneStep();return n};Ghost.prototype.randomMove=function(){var e=parseInt(Math.random()*4)+1;while(true){if(e!=oppositeDir(this.dir)&&canMove(this.x,this.y,e)){break}e=parseInt(Math.random()*4)+1}this.dir=e;this.moveOneStep()}